{"version":3,"file":"hyperbole.js","mappings":"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","sources":["webpack://web-ui/./node_modules/debounce/index.js","webpack://web-ui/webpack/bootstrap","webpack://web-ui/./node_modules/omdomdom/lib/omdomdom.es.js","webpack://web-ui/./src/response.ts","webpack://web-ui/./src/sockets.ts","webpack://web-ui/./src/lib.ts","webpack://web-ui/./src/action.ts","webpack://web-ui/./src/events.ts","webpack://web-ui/./src/http.ts","webpack://web-ui/./src/index.ts","webpack://web-ui/./src/browser.ts"],"sourcesContent":["function debounce(function_, wait = 100, options = {}) {\n\tif (typeof function_ !== 'function') {\n\t\tthrow new TypeError(`Expected the first parameter to be a function, got \\`${typeof function_}\\`.`);\n\t}\n\n\tif (wait < 0) {\n\t\tthrow new RangeError('`wait` must not be negative.');\n\t}\n\n\t// TODO: Deprecate the boolean parameter at some point.\n\tconst {immediate} = typeof options === 'boolean' ? {immediate: options} : options;\n\n\tlet storedContext;\n\tlet storedArguments;\n\tlet timeoutId;\n\tlet timestamp;\n\tlet result;\n\n\tfunction run() {\n\t\tconst callContext = storedContext;\n\t\tconst callArguments = storedArguments;\n\t\tstoredContext = undefined;\n\t\tstoredArguments = undefined;\n\t\tresult = function_.apply(callContext, callArguments);\n\t\treturn result;\n\t}\n\n\tfunction later() {\n\t\tconst last = Date.now() - timestamp;\n\n\t\tif (last < wait && last >= 0) {\n\t\t\ttimeoutId = setTimeout(later, wait - last);\n\t\t} else {\n\t\t\ttimeoutId = undefined;\n\n\t\t\tif (!immediate) {\n\t\t\t\tresult = run();\n\t\t\t}\n\t\t}\n\t}\n\n\tconst debounced = function (...arguments_) {\n\t\tif (\n\t\t\tstoredContext\n\t\t\t&& this !== storedContext\n\t\t\t&& Object.getPrototypeOf(this) === Object.getPrototypeOf(storedContext)\n\t\t) {\n\t\t\tthrow new Error('Debounced method called with different contexts of the same prototype.');\n\t\t}\n\n\t\tstoredContext = this; // eslint-disable-line unicorn/no-this-assignment\n\t\tstoredArguments = arguments_;\n\t\ttimestamp = Date.now();\n\n\t\tconst callNow = immediate && !timeoutId;\n\n\t\tif (!timeoutId) {\n\t\t\ttimeoutId = setTimeout(later, wait);\n\t\t}\n\n\t\tif (callNow) {\n\t\t\tresult = run();\n\t\t}\n\n\t\treturn result;\n\t};\n\n\tObject.defineProperty(debounced, 'isPending', {\n\t\tget() {\n\t\t\treturn timeoutId !== undefined;\n\t\t},\n\t});\n\n\tdebounced.clear = () => {\n\t\tif (!timeoutId) {\n\t\t\treturn;\n\t\t}\n\n\t\tclearTimeout(timeoutId);\n\t\ttimeoutId = undefined;\n\t};\n\n\tdebounced.flush = () => {\n\t\tif (!timeoutId) {\n\t\t\treturn;\n\t\t}\n\n\t\tdebounced.trigger();\n\t};\n\n\tdebounced.trigger = () => {\n\t\tresult = run();\n\n\t\tdebounced.clear();\n\t};\n\n\treturn debounced;\n}\n\n// Adds compatibility for ES modules\nmodule.exports.debounce = debounce;\n\nmodule.exports = debounce;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","/*!\n  * @license MIT (https://github.com/geotrev/omdomdom/blob/master/LICENSE)\n  * Omdomdom v0.3.2 (https://github.com/geotrev/omdomdom)\n  * Copyright 2023 George Treviranus <geowtrev@gmail.com>\n  */\nvar DATA_KEY_ATTRIBUTE$1 = \"data-key\";\nvar hasProperty = function hasProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n};\nvar keyIsValid = function keyIsValid(map, key) {\n  if (!key) return false;\n  if (hasProperty(map, key)) {\n    console.warn(\"[OmDomDom]: Children with duplicate keys detected. Children with duplicate keys will be skipped, resulting in dropped node references. Keys must be unique and non-indexed.\");\n    return false;\n  }\n  return true;\n};\nvar forEach = function forEach(items, fn) {\n  var length = items.length;\n  var idx = -1;\n  if (!length) return;\n  while (++idx < length) {\n    if (fn(items[idx], idx) === false) break;\n  }\n};\nvar createKeyMap = function createKeyMap(children) {\n  var map = {};\n  forEach(children, function (child) {\n    var key = child.attributes[DATA_KEY_ATTRIBUTE$1];\n    if (keyIsValid(map, key)) {\n      map[key] = child;\n    }\n  });\n  for (var _ in map) {\n    return map;\n  }\n};\nvar insertBefore = function insertBefore(parent, child, refNode) {\n  return parent.node.insertBefore(child.node, refNode);\n};\nvar assignVNode = function assignVNode(template, vNode) {\n  for (var property in template) {\n    vNode[property] = template[property];\n  }\n};\n\nvar toHTML = function toHTML(htmlString) {\n  var processedDOMString = htmlString.trim().replace(/\\s+</g, \"<\").replace(/>\\s+/g, \">\");\n  var parser = new DOMParser();\n  var context = parser.parseFromString(processedDOMString, \"text/html\");\n  return context.body;\n};\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"];\n  if (null != _i) {\n    var _s,\n      _e,\n      _x,\n      _r,\n      _arr = [],\n      _n = !0,\n      _d = !1;\n    try {\n      if (_x = (_i = _i.call(arr)).next, 0 === i) {\n        if (Object(_i) !== _i) return;\n        _n = !1;\n      } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0);\n    } catch (err) {\n      _d = !0, _e = err;\n    } finally {\n      try {\n        if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return;\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n}\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar Types = {\n  STRING: \"string\",\n  INT: \"number\",\n  BOOL: \"boolean\"\n};\nvar DomProperties = {};\nvar createRecord = function createRecord(attrName, propName, type) {\n  return {\n    attrName: attrName,\n    propName: propName,\n    type: type\n  };\n};\nvar stringProps = [[\"style\", \"cssText\"], [\"class\", \"className\"]];\nforEach(stringProps, function (_ref) {\n  var _ref2 = _slicedToArray(_ref, 2),\n    attr = _ref2[0],\n    property = _ref2[1];\n  DomProperties[attr] = createRecord(attr, property || attr, Types.STRING);\n});\nvar booleanProps = [\"autofocus\", \"draggable\", \"hidden\", \"checked\", \"multiple\", \"muted\", \"selected\"];\nforEach(booleanProps, function (attr) {\n  DomProperties[attr] = createRecord(attr, attr, Types.BOOL);\n});\nvar integerProps = [[\"tabindex\", \"tabIndex\"]];\nforEach(integerProps, function (_ref3) {\n  var _ref4 = _slicedToArray(_ref3, 2),\n    attr = _ref4[0],\n    property = _ref4[1];\n  DomProperties[attr] = createRecord(attr, property, Types.INT);\n});\nvar Namespace = {\n  xlink: {\n    prefix: \"xlink:\",\n    resource: \"http://www.w3.org/1999/xlink\"\n  },\n  xml: {\n    prefix: \"xml:\",\n    resource: \"http://www.w3.org/XML/1998/namespace\"\n  }\n};\n\nvar setProperty = function setProperty(element, type, prop, value) {\n  switch (type) {\n    case Types.STRING:\n      {\n        if (prop === DomProperties.style.propName) {\n          if (value === null) {\n            element.style[prop] = \"\";\n          } else {\n            element.style[prop] = value;\n          }\n        } else if (value === null) {\n          element[prop] = \"\";\n        } else {\n          element[prop] = value;\n        }\n        break;\n      }\n    case Types.INT:\n      {\n        if (value === null) {\n          var attr = prop.toLowerCase();\n          element.removeAttribute(attr);\n        } else if (value === \"0\") {\n          element[prop] = 0;\n        } else if (value === \"-1\") {\n          element[prop] = -1;\n        } else {\n          var parsed = parseInt(value, 10);\n          if (!isNaN(parsed)) {\n            element[prop] = parsed;\n          }\n        }\n        break;\n      }\n    case Types.BOOL:\n      {\n        if ([\"\", \"true\"].indexOf(value) < 0) {\n          element[prop] = false;\n        } else {\n          element[prop] = true;\n        }\n        break;\n      }\n  }\n};\n\nvar removeAttributes = function removeAttributes(vNode, attributes) {\n  forEach(attributes, function (attrName) {\n    if (hasProperty(DomProperties, attrName)) {\n      var propertyRecord = DomProperties[attrName];\n      setProperty(vNode.node, propertyRecord.type, propertyRecord.propName, null);\n    } else {\n      if (attrName in vNode.node) {\n        setProperty(vNode.node, Types.STRING, attrName, null);\n      }\n      vNode.node.removeAttribute(attrName);\n    }\n    delete vNode.attributes[attrName];\n  });\n};\nvar setAttributes = function setAttributes(vNode, attributes) {\n  for (var attrName in attributes) {\n    var value = attributes[attrName];\n    vNode.attributes[attrName] = value;\n    if (hasProperty(DomProperties, attrName)) {\n      var propertyRecord = DomProperties[attrName];\n      setProperty(vNode.node, propertyRecord.type, propertyRecord.propName, value);\n      continue;\n    }\n    if (attrName.startsWith(Namespace.xlink.prefix)) {\n      vNode.node.setAttributeNS(Namespace.xlink.resource, attrName, value);\n      continue;\n    }\n    if (attrName.startsWith(Namespace.xml.prefix)) {\n      vNode.node.setAttributeNS(Namespace.xml.resource, attrName, value);\n      continue;\n    }\n    if (attrName in vNode.node) {\n      setProperty(vNode.node, Types.STRING, attrName, value);\n    }\n    vNode.node.setAttribute(attrName, value || \"\");\n  }\n};\nvar getPropertyValues = function getPropertyValues(element, attributes) {\n  for (var attrName in DomProperties) {\n    var propertyRecord = DomProperties[attrName];\n    var propName = propertyRecord.propName;\n    var attrValue = element.getAttribute(attrName);\n    if (attrName === DomProperties.style.attrName) {\n      attributes[attrName] = element.style[propName];\n    } else if (typeof attrValue === \"string\") {\n      attributes[attrName] = attrValue;\n    }\n  }\n};\nvar getBaseAttributes = function getBaseAttributes(element) {\n  return Array.prototype.reduce.call(element.attributes, function (attributes, attrName) {\n    if (!hasProperty(DomProperties, attrName.name)) {\n      attributes[attrName.name] = attrName.value;\n    }\n    return attributes;\n  }, {});\n};\nvar getAttributes = function getAttributes(element) {\n  var attributes = getBaseAttributes(element);\n  getPropertyValues(element, attributes);\n  return attributes;\n};\nvar updateAttributes = function updateAttributes(template, vNode) {\n  var removedAttributes = [];\n  var changedAttributes = {};\n  for (var attrName in vNode.attributes) {\n    var oldValue = vNode.attributes[attrName];\n    var nextValue = template.attributes[attrName];\n    if (oldValue === nextValue) continue;\n    if (typeof nextValue === \"undefined\") {\n      removedAttributes.push(attrName);\n    }\n  }\n  for (var _attrName in template.attributes) {\n    var _oldValue = vNode.attributes[_attrName];\n    var _nextValue = template.attributes[_attrName];\n    if (_oldValue === _nextValue) continue;\n    if (typeof _nextValue !== \"undefined\") {\n      changedAttributes[_attrName] = _nextValue;\n    }\n  }\n  removeAttributes(vNode, removedAttributes);\n  setAttributes(vNode, changedAttributes);\n};\n\nvar DATA_KEY_ATTRIBUTE = \"data-key\";\nfunction patchChildren(template, vNode, patch) {\n  var templateChildrenLength = template.children.length;\n  var vNodeChildrenLength = vNode.children.length;\n  if (!templateChildrenLength && !vNodeChildrenLength) return;\n  var vNodeKeyMap = createKeyMap(vNode.children);\n  var nextChildren = Array(templateChildrenLength);\n  if (vNodeKeyMap !== undefined) {\n    forEach(template.children, function (templateChild, idx) {\n      var childNodes = vNode.node.childNodes;\n      var key = templateChild.attributes[DATA_KEY_ATTRIBUTE];\n      if (Object.prototype.hasOwnProperty.call(vNodeKeyMap, key)) {\n        var keyedChild = vNodeKeyMap[key];\n        if (Array.prototype.indexOf.call(childNodes, keyedChild.node) !== idx) {\n          insertBefore(vNode, keyedChild, childNodes[idx]);\n        }\n        nextChildren[idx] = keyedChild;\n        delete vNodeKeyMap[key];\n        patch(templateChild, nextChildren[idx]);\n      } else {\n        insertBefore(vNode, templateChild, childNodes[idx]);\n        nextChildren[idx] = templateChild;\n      }\n    });\n  } else {\n    forEach(template.children, function (templateChild, idx) {\n      var vNodeChild = vNode.children[idx];\n      if (typeof vNodeChild !== \"undefined\") {\n        patch(templateChild, vNodeChild);\n        nextChildren[idx] = vNodeChild;\n      } else {\n        vNode.node.appendChild(templateChild.node);\n        nextChildren[idx] = templateChild;\n      }\n    });\n  }\n  vNode.children = nextChildren;\n  var childNodesLength = vNode.node.childNodes.length;\n  var delta = childNodesLength - templateChildrenLength;\n  if (delta > 0) {\n    while (delta > 0) {\n      vNode.node.removeChild(vNode.node.childNodes[childNodesLength - 1]);\n      childNodesLength--;\n      delta--;\n    }\n  }\n}\n\nvar patch = function patch(template, vNode, rootNode) {\n  if (!template || !vNode) return;\n  rootNode = rootNode || vNode.node.parentNode;\n  var contentChanged = template.content && template.content !== vNode.content;\n  if (template.type !== vNode.type || contentChanged) {\n    rootNode.replaceChild(template.node, vNode.node);\n    return assignVNode(template, vNode);\n  }\n  updateAttributes(template, vNode);\n  patchChildren(template, vNode, patch);\n};\nvar render = function render(vNode, root) {\n  root.appendChild(vNode.node);\n};\nvar create = function create(node) {\n  var isSVGContext = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  if (typeof node === \"string\") {\n    node = toHTML(node);\n  }\n  var isRoot = node.tagName === \"BODY\";\n  var childNodes = node.childNodes;\n  var numChildNodes = childNodes ? childNodes.length : 0;\n  if (isRoot) {\n    if (numChildNodes > 1) {\n      throw new Error(\"[OmDomDom]: Your element should not have more than one root node.\");\n    } else if (numChildNodes === 0) {\n      throw new Error(\"[OmDomDom]: Your element should have at least one root node.\");\n    } else {\n      return create(childNodes[0]);\n    }\n  }\n  var type = node.nodeType === 3 ? \"text\" : node.nodeType === 8 ? \"comment\" : node.tagName.toLowerCase();\n  var isSVG = isSVGContext || type === \"svg\";\n  var attributes = node.nodeType === 1 ? getAttributes(node) : {};\n  var content = numChildNodes > 0 ? null : node.textContent;\n  var children = Array(numChildNodes);\n  forEach(childNodes, function (child, idx) {\n    children[idx] = create(child, isSVG);\n  });\n  return {\n    type: type,\n    attributes: attributes,\n    children: children,\n    content: content,\n    node: node,\n    isSVGContext: isSVG\n  };\n};\n\nexport { create, patch, render };\n//# sourceMappingURL=omdomdom.es.js.map\n","\n\n\n\nexport type Response = {\n  requestId: string\n  location?: string\n  query?: string\n  body: ResponseBody\n}\n\nexport type ResponseBody = string\n\nexport function parseResponse(res: ResponseBody): LiveUpdate {\n  const parser = new DOMParser()\n  const doc = parser.parseFromString(res, 'text/html')\n  const css = doc.querySelector(\"style\") as HTMLStyleElement\n  const content = doc.querySelector(\"div\") as HTMLElement\n\n  return {\n    content: content,\n    css: css\n  }\n}\n\nexport type LiveUpdate = {\n  content: HTMLElement\n  css: HTMLStyleElement\n}\n\n\nexport function fetchError(msg: string): Error {\n  let err = new Error()\n  err.name = \"Fetch Error\"\n  err.message = msg\n  return err\n}\n","import { ActionMessage, ViewId, RequestId } from './action'\nimport { takeWhileMap, dropWhile } from \"./lib\"\nimport { Response, ResponseBody, fetchError } from \"./response\"\n\nconst protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\nconst defaultAddress = `${protocol}//${window.location.host}${window.location.pathname}`\n\n\n\nexport class SocketConnection {\n\n\n  socket: WebSocket\n\n  hasEverConnected: Boolean\n  isConnected: Boolean\n  reconnectDelay: number = 0\n\n  constructor() { }\n\n  // we need to faithfully transmit the \n  connect(addr = defaultAddress) {\n    const sock = new WebSocket(addr)\n    this.socket = sock\n\n    function onConnectError(ev: Event) {\n      console.log(\"Connection Error\", ev)\n    }\n\n    sock.addEventListener('error', onConnectError)\n\n    sock.addEventListener('open', (event) => {\n      console.log(\"Opened\", event)\n      this.isConnected = true\n      this.hasEverConnected = true\n      this.reconnectDelay = 0\n      this.socket.removeEventListener('error', onConnectError)\n    })\n\n    // TODO: Don't reconnet if the socket server is OFF, only if we've successfully connected once\n    sock.addEventListener('close', _ => {\n      this.isConnected = false\n      console.log(\"Closed\")\n\n      // attempt to reconnect in 1s\n      if (this.hasEverConnected) {\n        this.reconnectDelay += 1000\n        console.log(\"Reconnecting in \" + (this.reconnectDelay / 1000) + \"s\")\n        setTimeout(() => this.connect(addr), this.reconnectDelay)\n      }\n    })\n  }\n\n  async sendAction(reqId: RequestId, action: ActionMessage): Promise<Response> {\n    // console.log(\"SOCKET sendAction\", action)\n    let msg = [action.url.pathname + action.url.search\n      , \"Host: \" + window.location.host\n      , \"Cookie: \" + document.cookie\n      , \"Request-Id: \" + reqId\n      , action.form\n    ].join(\"\\n\")\n    let { metadata, body } = await this.fetch(reqId, action.id, msg)\n\n    return {\n      requestId: metadata.requestId,\n      location: metadata.redirect,\n      query: metadata.query,\n      body\n    }\n\n  }\n\n  async fetch(reqId: RequestId, id: ViewId, msg: string): Promise<SocketResponse> {\n    this.sendMessage(msg)\n    let res = await this.waitMessage(reqId, id)\n    return res\n  }\n\n  private sendMessage(msg: string) {\n    this.socket.send(msg)\n  }\n\n  private async waitMessage(reqId: RequestId, id: ViewId): Promise<SocketResponse> {\n    return new Promise((resolve, reject) => {\n      const onMessage = (event: MessageEvent) => {\n        let data = event.data\n\n        let { metadata, body } = parseMetadataResponse(data)\n\n        if (!metadata.requestId) {\n          console.error(\"Missing RequestId!\", metadata, event.data)\n          return\n        }\n\n        if (metadata.requestId != reqId) {\n          // skip, it's not us!\n          return\n        }\n\n        if (metadata.error) {\n          throw fetchError(metadata.error)\n        }\n\n        // We have found our message. Remove the listener\n        this.socket.removeEventListener('message', onMessage)\n\n        // set the cookies. These happen automatically in http\n        metadata.cookies.forEach(cookie => {\n          document.cookie = cookie\n        })\n\n        resolve({ metadata, body })\n      }\n\n      this.socket.addEventListener('message', onMessage)\n      this.socket.addEventListener('error', reject)\n    })\n  }\n\n  disconnect() {\n    this.socket.close()\n  }\n}\n\n// function socketError(inp: string): Error {\n//   let error = new Error()\n//   error.name = inp.substring(0, inp.indexOf(' '));\n//   error.message = inp.substring(inp.indexOf(' ') + 1);\n//   return error\n// }\n\n\n\n\n\n\ntype SocketResponse = {\n  metadata: Metadata,\n  body: ResponseBody\n}\n\ntype Metadata = {\n  viewId?: ViewId\n  cookies: string[]\n  redirect?: string\n  error?: string\n  query?: string\n  requestId?: string\n}\n\ntype Meta = { key: string, value: string }\n\n\nfunction parseMetadataResponse(ret: string): SocketResponse {\n  let lines = ret.split(\"\\n\")\n  let metas: Meta[] = takeWhileMap(parseMeta, lines)\n  let rest = dropWhile(parseMeta, lines).join(\"\\n\")\n\n  return {\n    metadata: parseMetas(metas),\n    body: rest\n  }\n\n  function parseMeta(line: string): Meta | undefined {\n    let match = line.match(/^\\|([A-Z\\-]+)\\|(.*)$/)\n    if (match) {\n      return {\n        key: match[1],\n        value: match[2]\n      }\n    }\n  }\n}\n\nfunction parseMetas(meta: Meta[]): Metadata {\n\n  let requestId = meta.find(m => m.key == \"REQUEST-ID\")?.value\n\n  return {\n    cookies: meta.filter(m => m.key == \"COOKIE\").map(m => m.value),\n    redirect: meta.find(m => m.key == \"REDIRECT\")?.value,\n    error: meta.find(m => m.key == \"ERROR\")?.value,\n    viewId: meta.find(m => m.key == \"VIEW-ID\")?.value,\n    query: meta.find(m => m.key == \"QUERY\")?.value,\n    requestId\n  }\n}\n\n","\n\nexport function takeWhileMap<T, A>(pred:(val:T) => A | undefined, lines:T[]):A[] {\n  var output = []\n  for (var line of lines) {\n    let a = pred(line)\n    if (a)\n      output.push(a)\n    else\n      break;\n  }\n\n  return output\n}\n\nexport function dropWhile<T, A>(pred:(val:T) => A | undefined, lines:T[]):T[] {\n  let index = 0;\n  while (index < lines.length && pred(lines[index])) {\n    index++;\n  }\n  return lines.slice(index);\n}\n","export function actionUrl(id: ViewId, action: string): URL {\n  let url = new URL(window.location.href)\n  url.searchParams.append(\"hyp-id\", id)\n  url.searchParams.append(\"hyp-action\", action)\n  return url\n}\n\nexport function toSearch(form?: FormData): URLSearchParams | undefined {\n  if (!form) return undefined\n\n  const params = new URLSearchParams()\n\n  form.forEach((value, key) => {\n    params.append(key, value as string)\n  })\n\n  return params\n}\n\nexport function actionMessage(id: ViewId, action: string, form?: FormData): ActionMessage {\n  let url = actionUrl(id, action)\n  return { id, url, form: toSearch(form) }\n}\n\nexport type ActionMessage = {\n  id: ViewId\n  url: URL\n  form: URLSearchParams | undefined\n}\n\nexport type ViewId = string\n\n\nexport function inputToAction(action: string, value: string): string {\n  return action.replace(/%HYP-INP%/, sanitizeInput(value))\n}\n\n// WARNING: security flaw, unescaped output. no closing quotes allowed?\nfunction sanitizeInput(input: string): string {\n  // replace any escape characters: '/' etc\n  // replace any quotes with escaped quotes\n  return input.replace(/\\\\/g, \"\\\\\\\\\").replace(/\"/g, '\\\\\"')\n}\n\n\nexport type RequestId = string\n\nexport function requestId(): RequestId {\n  return Math.random().toString(36).substring(2, 8)\n}\n","\nimport * as debounce from 'debounce'\nimport { inputToAction } from './action'\n\nexport type UrlFragment = string\n\nexport function listenKeydown(cb: (target: HTMLElement, action: string) => void): void {\n  listenKeyEvent(\"Keydown\", cb)\n}\n\nexport function listenKeyup(cb: (target: HTMLElement, action: string) => void): void {\n  listenKeyEvent(\"Keyup\", cb)\n}\n\nexport function listenKeyEvent(event: string, cb: (target: HTMLElement, action: string) => void): void {\n  document.addEventListener(event.toLowerCase(), function(e: KeyboardEvent) {\n    let source = e.target as HTMLInputElement\n\n    let datasetKey = \"on\" + event + e.key\n    let action = source.dataset[datasetKey]\n    if (!action) return\n\n    e.preventDefault()\n    cb(nearestTarget(source), action)\n  })\n}\n\nexport function listenClick(cb: (target: HTMLElement, action: string) => void): void {\n  document.addEventListener(\"click\", function(e) {\n    let el = e.target as HTMLInputElement\n\n    // clicks can fire on internal elements. Find the parent with a click handler\n    let source = el.closest(\"[data-on-click]\") as HTMLElement\n\n    // Let the click do its thing\n    if (!source) return\n\n    e.preventDefault()\n    let target = nearestTarget(source)\n    cb(target, source.dataset.onClick)\n  })\n}\n\nexport function listenDblClick(cb: (target: HTMLElement, action: string) => void): void {\n  document.addEventListener(\"dblclick\", function(e) {\n    let el = e.target as HTMLInputElement\n\n    // console.log(\"DBL\", el.dataset)\n\n    // clicks can fire on internal elements. Find the parent with a click handler\n    let source = el.closest(\"[data-on-dblclick]\") as HTMLElement\n\n    // Let the click do its thing\n    if (!source) return\n\n    e.preventDefault()\n    let target = nearestTarget(source)\n    cb(target, source.dataset.onDblclick)\n  })\n}\n\n\nexport function listenLoadDocument(cb: (target: HTMLElement, action: string) => void): void {\n  document.addEventListener(\"hyp-load\", function(e: CustomEvent) {\n    let action = e.detail.onLoad\n    let target = e.detail.target\n    cb(target, action)\n  })\n\n}\n\n\nexport function listenLoad(node: HTMLElement): void {\n\n  // it doesn't really matter WHO runs this except that it should have target\n  node.querySelectorAll(\"[data-on-load]\").forEach((load: HTMLElement) => {\n    let delay = parseInt(load.dataset.delay) || 0\n    let onLoad = load.dataset.onLoad\n    // console.log(\"load start\", load.dataset.onLoad)\n\n    // load no longer exists!\n    // we should clear the timeout or back out if the dom is replaced in the interem\n    setTimeout(() => {\n      let target = nearestTarget(load)\n      // console.log(\"load go\", load.dataset.onLoad)\n\n      if (load.dataset.onLoad != onLoad) {\n        // the onLoad no longer exists\n        return\n      }\n\n      const event = new CustomEvent(\"hyp-load\", { bubbles: true, detail: { target, onLoad } })\n      load.dispatchEvent(event)\n    }, delay)\n  })\n}\n\n\nexport function listenChange(cb: (target: HTMLElement, action: string) => void): void {\n  document.addEventListener(\"change\", function(e) {\n    let el = e.target as HTMLElement\n\n    // clicks can fire on internal elements. Find the parent with a click handler\n    let source = el.closest(\"[data-on-change]\") as HTMLInputElement\n\n    if (!source) return\n    e.preventDefault()\n\n    // they should all have an action and target\n    if (!source.value) {\n      console.error(\"Missing input value:\", source)\n      return\n    }\n\n    let target = nearestTarget(source)\n    cb(target, source.value)\n  })\n}\n\ninterface LiveInputElement extends HTMLInputElement {\n  debouncedCallback?: Function;\n}\n\nexport function listenInput(cb: (target: HTMLElement, action: string) => void): void {\n  document.addEventListener(\"input\", function(e) {\n    let el = e.target as HTMLElement\n    let source = el.closest(\"[data-on-input]\") as LiveInputElement\n\n    if (!source) return\n\n    let delay = parseInt(source.dataset.delay) || 250\n    if (delay < 250) {\n      console.warn(\"Input delay < 100 can result in poor performance.\")\n    }\n\n    if (!source?.dataset.onInput) {\n      console.error(\"Missing onInput: \", source)\n      return\n    }\n\n    e.preventDefault()\n\n    let target = nearestTarget(source)\n\n    if (!source.debouncedCallback) {\n      source.debouncedCallback = debounce(() => {\n        let action = inputToAction(source.dataset.onInput, source.value)\n        cb(target, action)\n      }, delay)\n    }\n\n    source.debouncedCallback()\n  })\n}\n\n\n\nexport function listenFormSubmit(cb: (target: HTMLElement, action: string, form: FormData) => void): void {\n  document.addEventListener(\"submit\", function(e) {\n    let form = e.target as HTMLFormElement\n\n    // they should all have an action and target\n    if (!form?.dataset.onSubmit) {\n      console.error(\"Missing onSubmit: \", form)\n      return\n    }\n\n    e.preventDefault()\n\n    let target = nearestTarget(form)\n    const formData = new FormData(form)\n    cb(target, form.dataset.onSubmit, formData)\n  })\n}\n\nfunction nearestTargetId(node: HTMLElement): string | undefined {\n  let targetData = node.closest(\"[data-target]\") as HTMLElement | undefined\n  return targetData?.dataset.target || node.closest(\"[id]\")?.id\n}\n\nfunction nearestTarget(node: HTMLElement): HTMLElement {\n  let targetId = nearestTargetId(node)\n  let target = document.getElementById(targetId)\n\n  if (!target) {\n    console.error(\"Cannot find target: \", node)\n    return\n  }\n\n  return target\n}\n","import { ActionMessage, RequestId } from './action'\nimport { Response, fetchError } from \"./response\"\n\nexport async function sendActionHttp(reqId: RequestId, msg: ActionMessage): Promise<Response> {\n  // console.log(\"HTTP sendAction\", msg.url.toString())\n  let res = await fetch(msg.url, {\n    method: \"POST\",\n    headers:\n    {\n      'Accept': 'text/html',\n      'Content-Type': 'application/x-www-form-urlencoded',\n      'Request-Id': reqId\n    },\n    body: msg.form,\n    // we never want this to be redirected\n    redirect: \"manual\"\n  })\n\n  let body = await res.text()\n\n  if (!res.ok) {\n    throw fetchError(body)\n  }\n\n  let response: Response = {\n    requestId: res.headers.get(\"Request-Id\"),\n    location: res.headers.get(\"location\"),\n    query: res.headers.get(\"set-query\"),\n    body\n  }\n\n  return response\n}\n\n\n","import { patch, create } from \"omdomdom/lib/omdomdom.es.js\"\nimport { SocketConnection } from './sockets'\nimport { listenChange, listenClick, listenDblClick, listenFormSubmit, listenLoad, listenLoadDocument, listenInput, listenKeydown, listenKeyup } from './events'\nimport { actionMessage, ActionMessage, requestId, RequestId } from './action'\nimport { sendActionHttp } from './http'\nimport { setQuery } from \"./browser\"\nimport { parseResponse, Response, LiveUpdate } from './response'\n\nlet PACKAGE = require('../package.json');\n\n// import { listenEvents } from './events';\n// import { WEBSOCKET_ADDRESS, Messages } from './Messages'\n// import { INIT_PAGE, INIT_STATE, State, Class } from './types';\n// import { fromVDOM, VDOM } from './vdom'\n\n\n// const CONTENT_ID = \"yeti-root-content\"\n\n// console.log(\"VERSION 2\", INIT_PAGE, INIT_STATE)\nconsole.log(\"Hyperbole \" + PACKAGE.version)\n\n\nlet rootStyles: HTMLStyleElement;\nlet addedRulesIndex = new Set();\n\n\nasync function sendAction(reqId: RequestId, msg: ActionMessage): Promise<Response> {\n  if (sock.isConnected) {\n    return sock.sendAction(reqId, msg)\n  }\n  else {\n    return sendActionHttp(reqId, msg)\n  }\n}\n\n\nasync function fetchAction(reqId: RequestId, msg: ActionMessage): Promise<Response> {\n  try {\n    let res = await sendAction(reqId, msg)\n\n    if (res.location) {\n      window.location.href = res.location\n      return // not reachable\n    }\n\n    if (res.query != null) {\n      setQuery(res.query)\n    }\n\n    return res\n  }\n  catch (err) {\n    // handle error here\n    document.body.innerHTML = errorHTML(err)\n    throw err\n\n  }\n}\n\nasync function runAction(target: HTMLElement, action: string, form?: FormData) {\n\n  if (action === undefined) {\n    console.error(\"Undefined Action!\", target, \"this is a bug, please report: https://github.com/seanhess/hyperbole\")\n    return\n  }\n\n\n  let timeout = setTimeout(() => {\n    // add loading after 100ms, not right away\n    // if it runs shorter than that we probably don't want to add loading effects\n    target.classList.add(\"hyp-loading\")\n  }, 100)\n\n  let msg = actionMessage(target.id, action, form)\n\n  // Set the requestId\n  let reqId = requestId()\n  target.dataset.requestId = reqId\n\n  let res: Response = await fetchAction(reqId, msg)\n\n  if (reqId != target.dataset.requestId) {\n    console.warn(\"Ignoring Stale Action (\" + reqId + \"):\", action)\n    return\n  }\n\n  let update: LiveUpdate = parseResponse(res.body)\n\n  if (!update.css || !update.content) {\n    // TODO: error handling\n    console.error(\"Empty Response\", res)\n    return\n  }\n\n  // First, update the stylesheet\n  addCSS(update.css)\n\n  // Patch the node\n  const next: VNode = create(update.content)\n  const old: VNode = create(target)\n  patch(next, old)\n\n  // console.log(\"NEXT\", next)\n\n  // Emit relevant events\n  let newTarget = document.getElementById(target.id)\n  // let event = new Event(\"content\", {bubbles:true})\n  // newTarget.dispatchEvent(event)\n  //\n\n  // load doesn't bubble\n  if (newTarget) {\n    listenLoad(newTarget)\n  }\n  else {\n    console.warn(\"Target Missing: \", target.id)\n  }\n  // setCheckboxes(newTarget)\n\n  // Remove loading and clear add timeout\n\n  clearTimeout(timeout)\n  target.classList.remove(\"hyp-loading\")\n}\n\n\nfunction addCSS(src: HTMLStyleElement) {\n  const rules: any = src.sheet.cssRules\n  for (const rule of rules) {\n    if (addedRulesIndex.has(rule.cssText) == false) {\n      rootStyles.sheet.insertRule(rule.cssText);\n      addedRulesIndex.add(rule.cssText);\n    }\n  }\n}\n\n// function setCheckboxes(target: HTMLElement) {\n//   target.querySelectorAll(\"input[type=checkbox]\").forEach(input => {\n//     console.log(input.attributes)\n//   })\n// }\n\n\n\nfunction init() {\n  rootStyles = document.querySelector('style')\n\n  listenLoadDocument(async function(target: HTMLElement, action: string) {\n    runAction(target, action)\n  })\n\n  listenLoad(document.body)\n\n  listenClick(async function(target: HTMLElement, action: string) {\n    // console.log(\"CLICK\", target.id, action)\n    runAction(target, action)\n  })\n\n  listenDblClick(async function(target: HTMLElement, action: string) {\n    // console.log(\"DBLCLICK\", target.id, action)\n    runAction(target, action)\n  })\n\n  listenKeydown(async function(target: HTMLElement, action: string) {\n    // console.log(\"KEYDOWN\", target.id, action)\n    runAction(target, action)\n  })\n\n  listenKeyup(async function(target: HTMLElement, action: string) {\n    // console.log(\"KEYUP\", target.id, action)\n    runAction(target, action)\n  })\n\n  listenFormSubmit(async function(target: HTMLElement, action: string, form: FormData) {\n    // console.log(\"FORM\", target.id, action, form)\n    runAction(target, action, form)\n  })\n\n  listenChange(async function(target: HTMLElement, action: string) {\n    // console.log(\"CHANGE\", target.id, action)\n    runAction(target, action)\n  })\n\n  listenInput(async function(target: HTMLElement, action: string) {\n    console.log(\"INPUT\", target.id, action)\n    runAction(target, action)\n  })\n}\n\n\ndocument.addEventListener(\"DOMContentLoaded\", init)\n\n\n// Should we connect to the socket or not?\nconst sock = new SocketConnection()\nsock.connect()\n\n\n\n\n\n\ntype VNode = {\n  // One of three value types are used:\n  // - The tag name of the element\n  // - \"text\" if text node\n  // - \"comment\" if comment node\n  type: string\n\n  // An object whose key/value pairs are the attribute\n  // name and value, respectively\n  attributes: [string: string]\n\n  // Is set to `true` if a node is an `svg`, which tells\n  // Omdomdom to treat it, and its children, as such\n  isSVGContext: Boolean\n\n  // The content of a \"text\" or \"comment\" node\n  content: string\n\n  // An array of virtual node children\n  children: Array<VNode>\n\n  // The real DOM node\n  node: Node\n}\n\n\n\n// no it should take over the whole page...\nfunction errorHTML(error: Error): string {\n\n  // TODO: match on error.name and handle it differently\n  let style = [\n    \".hyp-error {background-color:#DB3524; color:white; padding: 10px}\",\n    \".hyp-details {padding: 10px}\"\n  ]\n  let content = `<div class='hyp-error'>${error.name}</div>`\n  let details = `<div class='hyp-details'>${error.message}</div>`\n\n  return [\"<style>\" + style.join(\"\\n\") + \"</style>\", content, details].join(\"\\n\")\n}\n","\nexport function setQuery(query: string) {\n  if (query != currentQuery()) {\n    if (query != \"\") query = \"?\" + query\n    let url = location.pathname + query\n    console.log(\"history.replaceState(\", url, \")\")\n    window.history.replaceState({}, \"\", url)\n  }\n}\n\nfunction currentQuery(): string {\n  const query = window.location.search;\n  return query.startsWith('?') ? query.substring(1) : query;\n}\n"],"names":["debounce","function_","wait","options","TypeError","RangeError","immediate","storedContext","storedArguments","timeoutId","timestamp","result","run","callContext","callArguments","undefined","apply","later","last","Date","now","setTimeout","debounced","arguments_","this","Object","getPrototypeOf","Error","callNow","defineProperty","get","clear","clearTimeout","flush","trigger","module","exports","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","hasProperty","obj","prop","prototype","hasOwnProperty","call","forEach","items","fn","length","idx","insertBefore","parent","child","refNode","node","_slicedToArray","arr","i","Array","isArray","_arrayWithHoles","_i","Symbol","iterator","_s","_e","_x","_r","_arr","_n","_d","next","done","push","value","err","return","_iterableToArrayLimit","o","minLen","_arrayLikeToArray","n","toString","slice","constructor","name","from","test","_unsupportedIterableToArray","_nonIterableRest","len","arr2","Types","DomProperties","createRecord","attrName","propName","type","_ref","_ref2","attr","property","_ref3","_ref4","Namespace","setProperty","element","style","toLowerCase","removeAttribute","parsed","parseInt","isNaN","indexOf","patch","template","vNode","rootNode","parentNode","contentChanged","content","replaceChild","assignVNode","removedAttributes","changedAttributes","attributes","oldValue","nextValue","_attrName","_oldValue","_nextValue","propertyRecord","removeAttributes","startsWith","setAttributeNS","setAttribute","setAttributes","updateAttributes","templateChildrenLength","children","vNodeChildrenLength","vNodeKeyMap","map","_","key","console","warn","keyIsValid","createKeyMap","nextChildren","templateChild","childNodes","keyedChild","vNodeChild","appendChild","childNodesLength","delta","removeChild","patchChildren","create","processedDOMString","isSVGContext","arguments","trim","replace","DOMParser","parseFromString","body","isRoot","tagName","numChildNodes","nodeType","isSVG","reduce","getBaseAttributes","attrValue","getAttribute","getPropertyValues","getAttributes","textContent","fetchError","msg","message","protocol","window","location","defaultAddress","host","pathname","reconnectDelay","connect","addr","sock","WebSocket","onConnectError","ev","log","socket","addEventListener","event","isConnected","hasEverConnected","removeEventListener","sendAction","reqId","action","url","search","document","cookie","form","join","fetch","id","metadata","requestId","redirect","query","sendMessage","waitMessage","send","Promise","resolve","reject","onMessage","ret","lines","split","metas","pred","output","a","takeWhileMap","parseMeta","rest","index","dropWhile","parseMetas","line","match","parseMetadataResponse","data","error","cookies","disconnect","close","meta","find","m","filter","viewId","toSearch","params","URLSearchParams","append","listenKeyEvent","cb","e","source","target","datasetKey","dataset","preventDefault","nearestTarget","listenLoad","querySelectorAll","load","delay","onLoad","CustomEvent","bubbles","detail","dispatchEvent","targetId","targetData","closest","nearestTargetId","getElementById","sendActionHttp","method","headers","res","text","ok","rootStyles","PACKAGE","version","addedRulesIndex","Set","fetchAction","href","substring","currentQuery","history","replaceState","setQuery","innerHTML","details","runAction","timeout","classList","add","URL","searchParams","actionUrl","actionMessage","Math","random","update","doc","css","querySelector","parseResponse","src","sheet","cssRules","rule","has","cssText","insertRule","addCSS","old","newTarget","remove","onClick","onDblclick","onSubmit","formData","FormData","onInput","debouncedCallback","inputToAction","SocketConnection"],"sourceRoot":""}