{"version":3,"file":"hyperbole.js","mappings":"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","sources":["webpack://web-ui/./node_modules/debounce/index.js","webpack://web-ui/webpack/bootstrap","webpack://web-ui/./node_modules/omdomdom/lib/omdomdom.es.js","webpack://web-ui/./src/action.ts","webpack://web-ui/./src/lib.ts","webpack://web-ui/./src/response.ts","webpack://web-ui/./src/sockets.ts","webpack://web-ui/./src/events.ts","webpack://web-ui/./src/http.ts","webpack://web-ui/./src/index.ts","webpack://web-ui/./src/browser.ts"],"sourcesContent":["function debounce(function_, wait = 100, options = {}) {\n\tif (typeof function_ !== 'function') {\n\t\tthrow new TypeError(`Expected the first parameter to be a function, got \\`${typeof function_}\\`.`);\n\t}\n\n\tif (wait < 0) {\n\t\tthrow new RangeError('`wait` must not be negative.');\n\t}\n\n\t// TODO: Deprecate the boolean parameter at some point.\n\tconst {immediate} = typeof options === 'boolean' ? {immediate: options} : options;\n\n\tlet storedContext;\n\tlet storedArguments;\n\tlet timeoutId;\n\tlet timestamp;\n\tlet result;\n\n\tfunction run() {\n\t\tconst callContext = storedContext;\n\t\tconst callArguments = storedArguments;\n\t\tstoredContext = undefined;\n\t\tstoredArguments = undefined;\n\t\tresult = function_.apply(callContext, callArguments);\n\t\treturn result;\n\t}\n\n\tfunction later() {\n\t\tconst last = Date.now() - timestamp;\n\n\t\tif (last < wait && last >= 0) {\n\t\t\ttimeoutId = setTimeout(later, wait - last);\n\t\t} else {\n\t\t\ttimeoutId = undefined;\n\n\t\t\tif (!immediate) {\n\t\t\t\tresult = run();\n\t\t\t}\n\t\t}\n\t}\n\n\tconst debounced = function (...arguments_) {\n\t\tif (\n\t\t\tstoredContext\n\t\t\t&& this !== storedContext\n\t\t\t&& Object.getPrototypeOf(this) === Object.getPrototypeOf(storedContext)\n\t\t) {\n\t\t\tthrow new Error('Debounced method called with different contexts of the same prototype.');\n\t\t}\n\n\t\tstoredContext = this; // eslint-disable-line unicorn/no-this-assignment\n\t\tstoredArguments = arguments_;\n\t\ttimestamp = Date.now();\n\n\t\tconst callNow = immediate && !timeoutId;\n\n\t\tif (!timeoutId) {\n\t\t\ttimeoutId = setTimeout(later, wait);\n\t\t}\n\n\t\tif (callNow) {\n\t\t\tresult = run();\n\t\t}\n\n\t\treturn result;\n\t};\n\n\tObject.defineProperty(debounced, 'isPending', {\n\t\tget() {\n\t\t\treturn timeoutId !== undefined;\n\t\t},\n\t});\n\n\tdebounced.clear = () => {\n\t\tif (!timeoutId) {\n\t\t\treturn;\n\t\t}\n\n\t\tclearTimeout(timeoutId);\n\t\ttimeoutId = undefined;\n\t};\n\n\tdebounced.flush = () => {\n\t\tif (!timeoutId) {\n\t\t\treturn;\n\t\t}\n\n\t\tdebounced.trigger();\n\t};\n\n\tdebounced.trigger = () => {\n\t\tresult = run();\n\n\t\tdebounced.clear();\n\t};\n\n\treturn debounced;\n}\n\n// Adds compatibility for ES modules\nmodule.exports.debounce = debounce;\n\nmodule.exports = debounce;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","/*!\n  * @license MIT (https://github.com/geotrev/omdomdom/blob/master/LICENSE)\n  * Omdomdom v0.3.2 (https://github.com/geotrev/omdomdom)\n  * Copyright 2023 George Treviranus <geowtrev@gmail.com>\n  */\nvar DATA_KEY_ATTRIBUTE$1 = \"data-key\";\nvar hasProperty = function hasProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n};\nvar keyIsValid = function keyIsValid(map, key) {\n  if (!key) return false;\n  if (hasProperty(map, key)) {\n    console.warn(\"[OmDomDom]: Children with duplicate keys detected. Children with duplicate keys will be skipped, resulting in dropped node references. Keys must be unique and non-indexed.\");\n    return false;\n  }\n  return true;\n};\nvar forEach = function forEach(items, fn) {\n  var length = items.length;\n  var idx = -1;\n  if (!length) return;\n  while (++idx < length) {\n    if (fn(items[idx], idx) === false) break;\n  }\n};\nvar createKeyMap = function createKeyMap(children) {\n  var map = {};\n  forEach(children, function (child) {\n    var key = child.attributes[DATA_KEY_ATTRIBUTE$1];\n    if (keyIsValid(map, key)) {\n      map[key] = child;\n    }\n  });\n  for (var _ in map) {\n    return map;\n  }\n};\nvar insertBefore = function insertBefore(parent, child, refNode) {\n  return parent.node.insertBefore(child.node, refNode);\n};\nvar assignVNode = function assignVNode(template, vNode) {\n  for (var property in template) {\n    vNode[property] = template[property];\n  }\n};\n\nvar toHTML = function toHTML(htmlString) {\n  var processedDOMString = htmlString.trim().replace(/\\s+</g, \"<\").replace(/>\\s+/g, \">\");\n  var parser = new DOMParser();\n  var context = parser.parseFromString(processedDOMString, \"text/html\");\n  return context.body;\n};\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"];\n  if (null != _i) {\n    var _s,\n      _e,\n      _x,\n      _r,\n      _arr = [],\n      _n = !0,\n      _d = !1;\n    try {\n      if (_x = (_i = _i.call(arr)).next, 0 === i) {\n        if (Object(_i) !== _i) return;\n        _n = !1;\n      } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0);\n    } catch (err) {\n      _d = !0, _e = err;\n    } finally {\n      try {\n        if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return;\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n}\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar Types = {\n  STRING: \"string\",\n  INT: \"number\",\n  BOOL: \"boolean\"\n};\nvar DomProperties = {};\nvar createRecord = function createRecord(attrName, propName, type) {\n  return {\n    attrName: attrName,\n    propName: propName,\n    type: type\n  };\n};\nvar stringProps = [[\"style\", \"cssText\"], [\"class\", \"className\"]];\nforEach(stringProps, function (_ref) {\n  var _ref2 = _slicedToArray(_ref, 2),\n    attr = _ref2[0],\n    property = _ref2[1];\n  DomProperties[attr] = createRecord(attr, property || attr, Types.STRING);\n});\nvar booleanProps = [\"autofocus\", \"draggable\", \"hidden\", \"checked\", \"multiple\", \"muted\", \"selected\"];\nforEach(booleanProps, function (attr) {\n  DomProperties[attr] = createRecord(attr, attr, Types.BOOL);\n});\nvar integerProps = [[\"tabindex\", \"tabIndex\"]];\nforEach(integerProps, function (_ref3) {\n  var _ref4 = _slicedToArray(_ref3, 2),\n    attr = _ref4[0],\n    property = _ref4[1];\n  DomProperties[attr] = createRecord(attr, property, Types.INT);\n});\nvar Namespace = {\n  xlink: {\n    prefix: \"xlink:\",\n    resource: \"http://www.w3.org/1999/xlink\"\n  },\n  xml: {\n    prefix: \"xml:\",\n    resource: \"http://www.w3.org/XML/1998/namespace\"\n  }\n};\n\nvar setProperty = function setProperty(element, type, prop, value) {\n  switch (type) {\n    case Types.STRING:\n      {\n        if (prop === DomProperties.style.propName) {\n          if (value === null) {\n            element.style[prop] = \"\";\n          } else {\n            element.style[prop] = value;\n          }\n        } else if (value === null) {\n          element[prop] = \"\";\n        } else {\n          element[prop] = value;\n        }\n        break;\n      }\n    case Types.INT:\n      {\n        if (value === null) {\n          var attr = prop.toLowerCase();\n          element.removeAttribute(attr);\n        } else if (value === \"0\") {\n          element[prop] = 0;\n        } else if (value === \"-1\") {\n          element[prop] = -1;\n        } else {\n          var parsed = parseInt(value, 10);\n          if (!isNaN(parsed)) {\n            element[prop] = parsed;\n          }\n        }\n        break;\n      }\n    case Types.BOOL:\n      {\n        if ([\"\", \"true\"].indexOf(value) < 0) {\n          element[prop] = false;\n        } else {\n          element[prop] = true;\n        }\n        break;\n      }\n  }\n};\n\nvar removeAttributes = function removeAttributes(vNode, attributes) {\n  forEach(attributes, function (attrName) {\n    if (hasProperty(DomProperties, attrName)) {\n      var propertyRecord = DomProperties[attrName];\n      setProperty(vNode.node, propertyRecord.type, propertyRecord.propName, null);\n    } else {\n      if (attrName in vNode.node) {\n        setProperty(vNode.node, Types.STRING, attrName, null);\n      }\n      vNode.node.removeAttribute(attrName);\n    }\n    delete vNode.attributes[attrName];\n  });\n};\nvar setAttributes = function setAttributes(vNode, attributes) {\n  for (var attrName in attributes) {\n    var value = attributes[attrName];\n    vNode.attributes[attrName] = value;\n    if (hasProperty(DomProperties, attrName)) {\n      var propertyRecord = DomProperties[attrName];\n      setProperty(vNode.node, propertyRecord.type, propertyRecord.propName, value);\n      continue;\n    }\n    if (attrName.startsWith(Namespace.xlink.prefix)) {\n      vNode.node.setAttributeNS(Namespace.xlink.resource, attrName, value);\n      continue;\n    }\n    if (attrName.startsWith(Namespace.xml.prefix)) {\n      vNode.node.setAttributeNS(Namespace.xml.resource, attrName, value);\n      continue;\n    }\n    if (attrName in vNode.node) {\n      setProperty(vNode.node, Types.STRING, attrName, value);\n    }\n    vNode.node.setAttribute(attrName, value || \"\");\n  }\n};\nvar getPropertyValues = function getPropertyValues(element, attributes) {\n  for (var attrName in DomProperties) {\n    var propertyRecord = DomProperties[attrName];\n    var propName = propertyRecord.propName;\n    var attrValue = element.getAttribute(attrName);\n    if (attrName === DomProperties.style.attrName) {\n      attributes[attrName] = element.style[propName];\n    } else if (typeof attrValue === \"string\") {\n      attributes[attrName] = attrValue;\n    }\n  }\n};\nvar getBaseAttributes = function getBaseAttributes(element) {\n  return Array.prototype.reduce.call(element.attributes, function (attributes, attrName) {\n    if (!hasProperty(DomProperties, attrName.name)) {\n      attributes[attrName.name] = attrName.value;\n    }\n    return attributes;\n  }, {});\n};\nvar getAttributes = function getAttributes(element) {\n  var attributes = getBaseAttributes(element);\n  getPropertyValues(element, attributes);\n  return attributes;\n};\nvar updateAttributes = function updateAttributes(template, vNode) {\n  var removedAttributes = [];\n  var changedAttributes = {};\n  for (var attrName in vNode.attributes) {\n    var oldValue = vNode.attributes[attrName];\n    var nextValue = template.attributes[attrName];\n    if (oldValue === nextValue) continue;\n    if (typeof nextValue === \"undefined\") {\n      removedAttributes.push(attrName);\n    }\n  }\n  for (var _attrName in template.attributes) {\n    var _oldValue = vNode.attributes[_attrName];\n    var _nextValue = template.attributes[_attrName];\n    if (_oldValue === _nextValue) continue;\n    if (typeof _nextValue !== \"undefined\") {\n      changedAttributes[_attrName] = _nextValue;\n    }\n  }\n  removeAttributes(vNode, removedAttributes);\n  setAttributes(vNode, changedAttributes);\n};\n\nvar DATA_KEY_ATTRIBUTE = \"data-key\";\nfunction patchChildren(template, vNode, patch) {\n  var templateChildrenLength = template.children.length;\n  var vNodeChildrenLength = vNode.children.length;\n  if (!templateChildrenLength && !vNodeChildrenLength) return;\n  var vNodeKeyMap = createKeyMap(vNode.children);\n  var nextChildren = Array(templateChildrenLength);\n  if (vNodeKeyMap !== undefined) {\n    forEach(template.children, function (templateChild, idx) {\n      var childNodes = vNode.node.childNodes;\n      var key = templateChild.attributes[DATA_KEY_ATTRIBUTE];\n      if (Object.prototype.hasOwnProperty.call(vNodeKeyMap, key)) {\n        var keyedChild = vNodeKeyMap[key];\n        if (Array.prototype.indexOf.call(childNodes, keyedChild.node) !== idx) {\n          insertBefore(vNode, keyedChild, childNodes[idx]);\n        }\n        nextChildren[idx] = keyedChild;\n        delete vNodeKeyMap[key];\n        patch(templateChild, nextChildren[idx]);\n      } else {\n        insertBefore(vNode, templateChild, childNodes[idx]);\n        nextChildren[idx] = templateChild;\n      }\n    });\n  } else {\n    forEach(template.children, function (templateChild, idx) {\n      var vNodeChild = vNode.children[idx];\n      if (typeof vNodeChild !== \"undefined\") {\n        patch(templateChild, vNodeChild);\n        nextChildren[idx] = vNodeChild;\n      } else {\n        vNode.node.appendChild(templateChild.node);\n        nextChildren[idx] = templateChild;\n      }\n    });\n  }\n  vNode.children = nextChildren;\n  var childNodesLength = vNode.node.childNodes.length;\n  var delta = childNodesLength - templateChildrenLength;\n  if (delta > 0) {\n    while (delta > 0) {\n      vNode.node.removeChild(vNode.node.childNodes[childNodesLength - 1]);\n      childNodesLength--;\n      delta--;\n    }\n  }\n}\n\nvar patch = function patch(template, vNode, rootNode) {\n  if (!template || !vNode) return;\n  rootNode = rootNode || vNode.node.parentNode;\n  var contentChanged = template.content && template.content !== vNode.content;\n  if (template.type !== vNode.type || contentChanged) {\n    rootNode.replaceChild(template.node, vNode.node);\n    return assignVNode(template, vNode);\n  }\n  updateAttributes(template, vNode);\n  patchChildren(template, vNode, patch);\n};\nvar render = function render(vNode, root) {\n  root.appendChild(vNode.node);\n};\nvar create = function create(node) {\n  var isSVGContext = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  if (typeof node === \"string\") {\n    node = toHTML(node);\n  }\n  var isRoot = node.tagName === \"BODY\";\n  var childNodes = node.childNodes;\n  var numChildNodes = childNodes ? childNodes.length : 0;\n  if (isRoot) {\n    if (numChildNodes > 1) {\n      throw new Error(\"[OmDomDom]: Your element should not have more than one root node.\");\n    } else if (numChildNodes === 0) {\n      throw new Error(\"[OmDomDom]: Your element should have at least one root node.\");\n    } else {\n      return create(childNodes[0]);\n    }\n  }\n  var type = node.nodeType === 3 ? \"text\" : node.nodeType === 8 ? \"comment\" : node.tagName.toLowerCase();\n  var isSVG = isSVGContext || type === \"svg\";\n  var attributes = node.nodeType === 1 ? getAttributes(node) : {};\n  var content = numChildNodes > 0 ? null : node.textContent;\n  var children = Array(numChildNodes);\n  forEach(childNodes, function (child, idx) {\n    children[idx] = create(child, isSVG);\n  });\n  return {\n    type: type,\n    attributes: attributes,\n    children: children,\n    content: content,\n    node: node,\n    isSVGContext: isSVG\n  };\n};\n\nexport { create, patch, render };\n//# sourceMappingURL=omdomdom.es.js.map\n","\nimport { takeWhileMap } from \"./lib\"\n\n\ntype EncodedAction = string\n\nexport type ActionMessage = {\n  viewId: ViewId\n  action: EncodedAction\n  requestId: RequestId\n  meta: Meta[]\n  form: URLSearchParams | undefined\n}\n\nexport type ViewId = string\nexport type RequestId = string\n\n\n\nexport function actionMessage(id: ViewId, action: EncodedAction, reqId: RequestId, form?: FormData): ActionMessage {\n  let meta: Meta[] = [\n    { key: \"Cookie\", value: decodeURI(document.cookie) },\n    { key: \"Query\", value: window.location.search }\n  ]\n\n  return { viewId: id, action, requestId: reqId, meta, form: toSearch(form) }\n}\n\nexport function toSearch(form?: FormData): URLSearchParams | undefined {\n  if (!form) return undefined\n\n  const params = new URLSearchParams()\n\n  form.forEach((value, key) => {\n    params.append(key, value as string)\n  })\n\n  return params\n}\n\nexport function renderActionMessage(msg: ActionMessage): string {\n  let header = [\n    \"|ACTION|\",\n    \"ViewId: \" + msg.viewId,\n    \"Action: \" + msg.action,\n    \"RequestId: \" + msg.requestId\n  ]\n\n\n  return [\n    header.join('\\n'),\n    renderMetadata(msg.meta),\n  ].join('\\n') + renderForm(msg.form)\n}\n\n\nexport function renderForm(form: URLSearchParams | undefined): string {\n  if (!form) return \"\"\n  return \"\\n\\n\" + form\n}\n\n\nexport function requestId(): RequestId {\n  return Math.random().toString(36).substring(2, 8)\n}\n\n\n// Metadata -------------------------------------\n\n\ntype Meta = { key: string, value: string }\ntype RemoteEvent = { name: string, detail: any }\n\nexport type Metadata = {\n  requestId: string\n  cookies: string[]\n  redirect?: string\n  error?: string\n  query?: string\n  events?: RemoteEvent[]\n  actions?: [ViewId, string][],\n  pageTitle?: string\n}\n\n\nexport type ParsedResponse = {\n  metadata: Metadata,\n  rest: string[]\n}\n\nexport function renderMetadata(meta: Meta[]): string {\n  return meta.map(m => m.key + \": \" + m.value).join('\\n')\n}\n\nexport function parseMetas(meta: Meta[]): Metadata {\n\n  let requestId = meta.find(m => m.key == \"RequestId\")?.value\n\n  return {\n    cookies: meta.filter(m => m.key == \"Cookie\").map(m => m.value),\n    redirect: meta.find(m => m.key == \"Redirect\")?.value,\n    error: meta.find(m => m.key == \"Error\")?.value,\n    query: meta.find(m => m.key == \"Query\")?.value,\n    events: meta.filter(m => m.key == \"Event\").map((m) => parseRemoteEvent(m.value)),\n    actions: meta.filter(m => m.key == \"Trigger\").map((m) => parseAction(m.value)),\n    pageTitle: meta.find(m => m.key == \"PageTitle\")?.value,\n    requestId\n  }\n}\n// viewId: meta.find(m => m.key == \"VIEW-ID\")?.value,\n\n// decode entities\nexport function parseMetadata(input: string): Metadata {\n  return splitMetadata(input.trim().split(\"\\n\")).metadata\n\n}\n\nexport function splitMetadata(lines: string[]): ParsedResponse {\n  let metas: Meta[] = takeWhileMap(parseMeta, lines)\n  // console.log(\"Split Metadata\", lines.length)\n  // console.log(\" [0]\", lines[0])\n  // console.log(\" [1]\", lines[1])\n  let rest = lines.slice(metas.length)\n\n  return {\n    metadata: parseMetas(metas),\n    rest: rest\n  }\n\n}\n\n\nexport function parseRemoteEvent(input: string): RemoteEvent {\n  let [name, data] = breakNextSegment(input)\n  return {\n    name,\n    detail: JSON.parse(data)\n  }\n}\n\nexport function parseAction(input: string): [ViewId, string] {\n  let [viewId, action] = breakNextSegment(input)\n  return [viewId, action]\n}\n\nfunction breakNextSegment(input: string): [string, string] | undefined {\n  let ix = input.indexOf('|')\n  if (ix === -1) {\n    let err = new Error(\"Bad Encoding, Expected Segment\")\n    err.message = input\n    throw err\n  }\n  return [input.slice(0, ix), input.slice(ix + 1)]\n}\n\nexport function parseMeta(line: string): Meta | undefined {\n  let match = line.match(/^(\\w+)\\: (.*)$/)\n  if (match) {\n    return {\n      key: match[1],\n      value: match[2]\n    }\n  }\n}\n\n// Sanitized Encoding ------------------------------------\n\nexport function encodedTextInput(action: string, value: string): string {\n  return action + ' \"' + sanitizeInput(value) + '\"'\n}\n\nexport function encodedJSONInput(action: string, value: string): string {\n  return action + \" \" + value\n}\n\n\n// WARNING: security flaw, unescaped output. no closing quotes allowed?\nfunction sanitizeInput(input: string): string {\n  // replace any escape characters: '/' etc\n  // replace any quotes with escaped quotes\n  return input.replace(/\\\\/g, \"\\\\\\\\\").replace(/\"/g, '\\\\\"')\n}\n","\n\nexport function takeWhileMap<T, A>(pred: (val: T) => A | undefined, lines: T[]): A[] {\n  var output = []\n  for (var line of lines) {\n    let a = pred(line)\n    if (a)\n      output.push(a)\n    else\n      break;\n  }\n\n  return output\n}\n\n// export function dropWhile<T, A>(pred: (val: T) => A | undefined, lines: T[]): T[] {\n//   let index = 0;\n//   while (index < lines.length && pred(lines[index])) {\n//     index++;\n//   }\n//   return lines.slice(index);\n// }\n//\n","\nimport { ViewId } from './action'\nimport { Metadata } from \"./action\"\n\n\n\nexport type Response = {\n  meta: Metadata\n  body: ResponseBody\n}\n\nexport type ResponseBody = string\n\nexport function parseResponse(res: ResponseBody): LiveUpdate {\n  const parser = new DOMParser()\n  const doc = parser.parseFromString(res, 'text/html')\n  const css = doc.querySelector(\"style\") as HTMLStyleElement\n  const content = doc.querySelector(\"div\") as HTMLElement\n\n  return {\n    content: content,\n    css: css\n  }\n}\n\nexport type LiveUpdate = {\n  content: HTMLElement\n  css: HTMLStyleElement | null\n}\n\n\nexport class FetchError extends Error {\n  viewId: ViewId\n  body: string\n  constructor(viewId: ViewId, msg: string, body: string) {\n    super(msg)\n    this.viewId = viewId\n    this.name = \"Fetch Error\"\n    this.body = body\n  }\n}\n","import { ActionMessage, ViewId, RequestId, renderActionMessage } from './action'\nimport { Metadata, ParsedResponse, splitMetadata } from \"./action\"\nimport { Response, FetchError } from \"./response\"\n\nconst protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\nconst defaultAddress = `${protocol}//${window.location.host}${window.location.pathname}`\n\n\n\nexport class SocketConnection {\n  socket: WebSocket\n\n  hasEverConnected: Boolean\n  isConnected: Boolean\n  reconnectDelay: number = 0\n\n  constructor() {\n  }\n\n  // we need to faithfully transmit the \n  connect(addr = defaultAddress) {\n    const sock = new WebSocket(addr)\n    this.socket = sock\n\n    function onConnectError(ev: Event) {\n      console.log(\"Connection Error\", ev)\n    }\n\n    sock.addEventListener('error', onConnectError)\n\n    sock.addEventListener('open', (_event) => {\n      console.log(\"Websocket Connected\")\n\n      if (this.hasEverConnected) {\n        document.dispatchEvent(new Event(\"hyp-socket-reconnect\"))\n      }\n\n      this.isConnected = true\n      this.hasEverConnected = true\n      this.reconnectDelay = 1000\n      this.socket.removeEventListener('error', onConnectError)\n      document.dispatchEvent(new Event(\"hyp-socket-connect\"))\n    })\n\n    sock.addEventListener('close', _ => {\n      if (this.isConnected) {\n        document.dispatchEvent(new Event(\"hyp-socket-disconnect\"))\n      }\n\n      this.isConnected = false\n\n      // attempt to reconnect in 1s\n      if (this.hasEverConnected) {\n        console.log(\"Reconnecting in \" + (this.reconnectDelay / 1000) + \"s\")\n        setTimeout(() => this.connect(addr), this.reconnectDelay)\n      }\n\n    })\n  }\n\n  async sendAction(action: ActionMessage): Promise<Response> {\n    let msg = renderActionMessage(action)\n    let { metadata, rest } = await this.fetch(action.requestId, action.viewId, msg)\n\n    return {\n      meta: metadata,\n      body: rest.join('\\n')\n    }\n\n  }\n\n  async fetch(reqId: RequestId, id: ViewId, msg: string): Promise<ParsedResponse> {\n    this.sendMessage(msg)\n    let res = await this.waitMessage(reqId, id)\n    return res\n  }\n\n  private sendMessage(msg: string) {\n    this.socket.send(msg)\n  }\n\n  private async waitMessage(reqId: RequestId, id: ViewId): Promise<ParsedResponse> {\n    return new Promise((resolve, reject) => {\n      const onMessage = (event: MessageEvent) => {\n        let data: string = event.data\n        let lines = data.split(\"\\n\").slice(1)  // drop the command line\n\n        let parsed = splitMetadata(lines)\n        let metadata: Metadata = parsed.metadata\n\n        if (!metadata.requestId) {\n          console.error(\"Missing RequestId!\", metadata, event.data)\n          return\n        }\n\n        if (metadata.requestId != reqId) {\n          // skip, it's not us!\n          return\n        }\n\n\n        // We have found our message. Remove the listener\n        this.socket.removeEventListener('message', onMessage)\n\n        // set the cookies. These happen automatically in http\n        metadata.cookies.forEach((cookie: string) => {\n          document.cookie = cookie\n        })\n\n        if (metadata.error) {\n          reject(new FetchError(id, metadata.error, parsed.rest.join('\\n')))\n          return\n        }\n\n        resolve(parsed)\n      }\n\n      this.socket.addEventListener('message', onMessage)\n      this.socket.addEventListener('error', reject)\n    })\n  }\n\n  disconnect() {\n    this.socket.close()\n  }\n}\n\n\n\n\n\n\n","\nimport * as debounce from 'debounce'\nimport { encodedTextInput, encodedJSONInput } from './action'\n\nexport type UrlFragment = string\n\nexport function listenKeydown(cb: (target: HTMLElement, action: string) => void): void {\n  listenKeyEvent(\"Keydown\", cb)\n}\n\nexport function listenKeyup(cb: (target: HTMLElement, action: string) => void): void {\n  listenKeyEvent(\"Keyup\", cb)\n}\n\nexport function listenKeyEvent(event: string, cb: (target: HTMLElement, action: string) => void): void {\n  document.addEventListener(event.toLowerCase(), function(e: KeyboardEvent) {\n    let source = e.target as HTMLInputElement\n\n    let datasetKey = \"on\" + event + e.key\n    let action = source.dataset[datasetKey]\n    if (!action) return\n\n    e.preventDefault()\n    cb(nearestTarget(source), action)\n  })\n}\n\nexport function listenBubblingEvent(event: string, cb: (target: HTMLElement, action: string) => void): void {\n  document.addEventListener(event, function(e) {\n    let el = e.target as HTMLInputElement\n\n    // clicks can fire on internal elements. Find the parent with a click handler\n    let source = el.closest(\"[data-on\" + event + \"]\") as HTMLElement\n    if (!source) return\n\n    e.preventDefault()\n    let target = nearestTarget(source)\n    cb(target, source.dataset[\"on\" + event])\n  })\n}\n\nexport function listenClick(cb: (target: HTMLElement, action: string) => void): void {\n  listenBubblingEvent(\"click\", cb)\n}\n\nexport function listenDblClick(cb: (target: HTMLElement, action: string) => void): void {\n  listenBubblingEvent(\"dblclick\", cb)\n}\n\n\nexport function listenTopLevel(cb: (target: HTMLElement, action: string) => void): void {\n  document.addEventListener(\"hyp-load\", function(e: CustomEvent) {\n    let action = e.detail.onLoad\n    let target = e.detail.target\n    cb(target, action)\n  })\n\n  document.addEventListener(\"hyp-mouseenter\", function(e: CustomEvent) {\n    let action = e.detail.onMouseEnter\n    let target = e.detail.target\n    cb(target, action)\n  })\n\n  document.addEventListener(\"hyp-mouseleave\", function(e: CustomEvent) {\n    let action = e.detail.onMouseLeave\n    let target = e.detail.target\n    cb(target, action)\n  })\n}\n\n\nexport function listenLoad(node: HTMLElement): void {\n\n  // it doesn't really matter WHO runs this except that it should have target\n  node.querySelectorAll(\"[data-onload]\").forEach((load: HTMLElement) => {\n    let delay = parseInt(load.dataset.delay) || 0\n    let onLoad = load.dataset.onload\n    // console.log(\"load start\", load.dataset.onLoad)\n\n    // load no longer exists!\n    // we should clear the timeout or back out if the dom is replaced in the interem\n    setTimeout(() => {\n      let target = nearestTarget(load)\n      // console.log(\"load go\", load.dataset.onLoad)\n\n      if (load.dataset.onload != onLoad) {\n        // the onLoad no longer exists\n        return\n      }\n\n      const event = new CustomEvent(\"hyp-load\", { bubbles: true, detail: { target, onLoad } })\n      load.dispatchEvent(event)\n    }, delay)\n  })\n}\n\nexport function listenMouseEnter(node: HTMLElement): void {\n  node.querySelectorAll(\"[data-onmouseenter]\").forEach((node: HTMLElement) => {\n    let onMouseEnter = node.dataset.onmouseenter\n\n    let target = nearestTarget(node)\n\n    node.onmouseenter = () => {\n      const event = new CustomEvent(\"hyp-mouseenter\", { bubbles: true, detail: { target, onMouseEnter } })\n      node.dispatchEvent(event)\n    }\n  })\n}\n\nexport function listenMouseLeave(node: HTMLElement): void {\n  node.querySelectorAll(\"[data-onmouseleave]\").forEach((node: HTMLElement) => {\n    let onMouseLeave = node.dataset.onmouseleave\n\n    let target = nearestTarget(node)\n\n    node.onmouseleave = () => {\n      const event = new CustomEvent(\"hyp-mouseleave\", { bubbles: true, detail: { target, onMouseLeave } })\n      node.dispatchEvent(event)\n    }\n  })\n}\n\n\nexport function listenChange(cb: (target: HTMLElement, action: string) => void): void {\n  document.addEventListener(\"change\", function(e) {\n    let el = e.target as HTMLElement\n\n    let source = el.closest(\"[data-onchange]\") as HTMLInputElement\n\n    if (!source) return\n    e.preventDefault()\n\n    if (!source.value) {\n      console.error(\"Missing input value:\", source)\n      return\n    }\n\n    let target = nearestTarget(source)\n    let action = encodedJSONInput(source.dataset.onchange, source.value)\n    cb(target, action)\n  })\n}\n\ninterface LiveInputElement extends HTMLInputElement {\n  debouncedCallback?: Function;\n}\n\nexport function listenInput(cb: (target: HTMLElement, action: string) => void): void {\n  document.addEventListener(\"input\", function(e) {\n    let el = e.target as HTMLElement\n    let source = el.closest(\"[data-oninput]\") as LiveInputElement\n\n    if (!source) return\n\n    let delay = parseInt(source.dataset.delay) || 250\n    if (delay < 250) {\n      console.warn(\"Input delay < 250 can result in poor performance.\")\n    }\n\n    if (!source?.dataset.oninput) {\n      console.error(\"Missing onInput: \", source)\n      return\n    }\n\n    e.preventDefault()\n\n    let target = nearestTarget(source)\n\n    if (!source.debouncedCallback) {\n      source.debouncedCallback = debounce(() => {\n        let action = encodedTextInput(source.dataset.oninput, source.value)\n        cb(target, action)\n      }, delay)\n    }\n\n    source.debouncedCallback()\n  })\n}\n\n\n\nexport function listenFormSubmit(cb: (target: HTMLElement, action: string, form: FormData) => void): void {\n  document.addEventListener(\"submit\", function(e) {\n    let form = e.target as HTMLFormElement\n\n    if (!form?.dataset.onsubmit) {\n      console.error(\"Missing onSubmit: \", form)\n      return\n    }\n\n    e.preventDefault()\n\n    let target = nearestTarget(form)\n    const formData = new FormData(form)\n    cb(target, form.dataset.onsubmit, formData)\n  })\n}\n\nfunction nearestTargetId(node: HTMLElement): string | undefined {\n  let targetData = node.closest(\"[data-target]\") as HTMLElement | undefined\n  return targetData?.dataset.target || node.closest(\"[id]\")?.id\n}\n\nfunction nearestTarget(node: HTMLElement): HTMLElement {\n  let targetId = nearestTargetId(node)\n  let target = document.getElementById(targetId)\n\n  if (!target) {\n    console.error(\"Cannot find target: \", targetId, node)\n    return\n  }\n\n  return target\n}\n","import { ActionMessage, splitMetadata, ParsedResponse } from './action'\nimport { Response, FetchError } from \"./response\"\n\nexport async function sendActionHttp(msg: ActionMessage): Promise<Response> {\n  // console.log(\"HTTP sendAction\", msg.url.toString())\n  let url = window.location.href\n  let res = await fetch(url, {\n    method: \"POST\",\n    headers:\n    {\n      'Accept': 'text/html',\n      'Content-Type': 'application/x-www-form-urlencoded',\n      'Hyp-RequestId': msg.requestId,\n      'Hyp-ViewId': msg.viewId,\n      'Hyp-Action': msg.action\n    },\n    body: msg.form,\n    // we never want this to be redirected\n    redirect: \"manual\"\n  })\n\n  let body = await res.text()\n  let { metadata, rest } = parseMetadataHttp(body)\n\n  if (!res.ok) {\n    throw new FetchError(msg.viewId, body, body)\n  }\n\n  let response: Response = {\n    meta: metadata,\n    body: rest.join('\\n')\n  }\n\n  return response\n}\n\n\nexport function parseMetadataHttp(inp: string): ParsedResponse {\n  let lines = inp.split(\"\\n\")\n  // drop the <script> start line\n  let { metadata, rest } = splitMetadata(lines.slice(1))\n  // drop the </script> end line and 2x whitespace\n  return { metadata, rest: rest.slice(2) }\n}\n\n\n","import { patch, create } from \"omdomdom/lib/omdomdom.es.js\"\nimport { SocketConnection } from './sockets'\nimport { listenChange, listenClick, listenDblClick, listenFormSubmit, listenLoad, listenTopLevel, listenInput, listenKeydown, listenKeyup, listenMouseEnter, listenMouseLeave } from './events'\nimport { actionMessage, ActionMessage, requestId, ViewId, parseMetadata, Metadata } from './action'\nimport { sendActionHttp } from './http'\nimport { setQuery } from \"./browser\"\nimport { parseResponse, Response, LiveUpdate } from './response'\n\nlet PACKAGE = require('../package.json');\n\n\n// console.log(\"VERSION 2\", INIT_PAGE, INIT_STATE)\nconsole.log(\"Hyperbole \" + PACKAGE.version)\n\n\nlet rootStyles: HTMLStyleElement;\nlet addedRulesIndex = new Set();\n\n\nasync function sendAction(msg: ActionMessage): Promise<Response> {\n  if (sock.isConnected) {\n    return sock.sendAction(msg)\n  }\n  else {\n    return sendActionHttp(msg)\n  }\n}\n\n\n\nasync function runAction(target: HyperView, action: string, form?: FormData) {\n  // console.log(\"runAction\", target.id, action)\n\n  if (target === undefined) {\n    console.error(\"Undefined HyperView!\")\n    return\n  }\n\n  if (action === undefined) {\n    console.error(\"Undefined Action!\", target, \"this is a bug, please report: https://github.com/seanhess/hyperbole\")\n    return\n  }\n\n  let timeout = setTimeout(() => {\n    // add loading after 100ms, not right away\n    // if it runs shorter than that we probably don't want to add loading effects\n    target.classList.add(\"hyp-loading\")\n  }, 100)\n\n  let reqId = requestId()\n  let msg = actionMessage(target.id, action, reqId, form)\n\n  // Ignore any request if a requestId is active\n  if (target.dataset.requestId) {\n    console.warn(\"Action overlaps with active request (\" + target.dataset.requestId + \")\", action)\n    return\n  }\n\n  // Set the requestId\n  target.dataset.requestId = reqId\n\n  try {\n    let res: Response = await sendAction(msg)\n\n    if (res.meta.requestId != target.dataset.requestId) {\n      let err = new Error()\n      err.name = \"Concurrency Error\"\n      err.message = \"Stale Action (\" + reqId + \"):\" + action\n      throw err\n    }\n    else {\n      delete target.dataset.requestId\n    }\n\n    let shouldStop = runMetadataImmediate(res.meta)\n\n    if (shouldStop) {\n      return\n    }\n\n    let update: LiveUpdate = parseResponse(res.body)\n\n    if (!update.content) {\n      console.error(\"Empty Response!\", res.body)\n      return\n    }\n\n    // First, update the stylesheet\n    addCSS(update.css)\n\n\n    // Patch the node\n    const old: VNode = create(target)\n    let next: VNode = create(update.content)\n    next.attributes = old.attributes\n    patch(next, old)\n\n\n    // Emit relevant events\n    let newTarget = document.getElementById(target.id)\n    dispatchContent(newTarget)\n\n    if (newTarget) {\n      // execute the metadata, anything that doesn't interrupt the dom update\n      runMetadataDOM(res.meta, newTarget)\n\n      // now way for these to bubble)\n      listenLoad(newTarget)\n      listenMouseEnter(newTarget)\n      listenMouseLeave(newTarget)\n      fixInputs(newTarget)\n      enrichHyperViews(newTarget)\n    }\n    else {\n      console.warn(\"Target Missing: \", target.id)\n    }\n\n  }\n  catch (err) {\n    console.error(\"Caught Error in HyperView (\" + target.id + \"):\\n\", err)\n\n    // Hyperbole catches handler errors, and the server controls what to display to the user on an error\n    //  but if you manage to crash your parent server process somehow, the response may be empty\n    target.innerHTML = err.body || \"<div style='background:red;color:white;padding:10px'>Hyperbole Internal Error</div>\"\n  }\n\n\n  // Remove loading and clear add timeout\n  clearTimeout(timeout)\n  target.classList.remove(\"hyp-loading\")\n}\n\nfunction runMetadataImmediate(meta: Metadata): boolean {\n  if (meta.redirect) {\n    // perform a redirect immediately\n    window.location.href = meta.redirect\n    return true\n  }\n\n  if (meta.query != null) {\n    setQuery(meta.query)\n  }\n\n  if (meta.pageTitle != null) {\n    document.title = meta.pageTitle\n  }\n}\n\nfunction runMetadataDOM(meta: Metadata, target?: HTMLElement) {\n  for (var remoteEvent of meta.events) {\n    setTimeout(() => {\n      // console.log(\"dipsatching custom event\", remoteEvent)\n      let event = new CustomEvent(remoteEvent.name, { bubbles: true, detail: remoteEvent.detail })\n      let eventTarget = target || document\n      eventTarget.dispatchEvent(event)\n    }, 10)\n  }\n\n  meta.actions.forEach(([viewId, action]) => {\n    setTimeout(() => {\n      let view = window.Hyperbole.hyperView(viewId)\n      if (view) {\n        runAction(view, action)\n      }\n    }, 10)\n  })\n}\n\n\nfunction fixInputs(target: HTMLElement) {\n  let focused = target.querySelector(\"[autofocus]\") as HTMLInputElement\n  if (focused?.focus) {\n    focused.focus()\n  }\n\n  target.querySelectorAll(\"input[value]\").forEach((input: HTMLInputElement) => {\n    let val = input.getAttribute(\"value\")\n    if (val !== undefined) {\n      input.value = val\n    }\n  })\n\n  target.querySelectorAll(\"input[type=checkbox]\").forEach((checkbox: HTMLInputElement) => {\n    let checked = checkbox.dataset.checked == \"True\"\n    checkbox.checked = checked\n  })\n}\n\nfunction addCSS(src: HTMLStyleElement | null) {\n  if (!src) return;\n  const rules: any = src.sheet.cssRules\n  for (const rule of rules) {\n    if (addedRulesIndex.has(rule.cssText) == false) {\n      rootStyles.sheet.insertRule(rule.cssText);\n      addedRulesIndex.add(rule.cssText);\n    }\n  }\n}\n\n\n\n\nfunction init() {\n  // metadata attached to initial page loads need to be executed\n  let meta = parseMetadata(document.getElementById(\"hyp.metadata\").innerText)\n  runMetadataImmediate(meta)\n  runMetadataDOM(meta)\n\n  rootStyles = document.querySelector('style')\n\n  listenTopLevel(async function(target: HyperView, action: string) {\n    runAction(target, action)\n  })\n\n  listenLoad(document.body)\n  listenMouseEnter(document.body)\n  listenMouseLeave(document.body)\n  enrichHyperViews(document.body)\n\n\n  listenClick(async function(target: HyperView, action: string) {\n    // console.log(\"CLICK\", target.id, action)\n    runAction(target, action)\n  })\n\n  listenDblClick(async function(target: HyperView, action: string) {\n    // console.log(\"DBLCLICK\", target.id, action)\n    runAction(target, action)\n  })\n\n  listenKeydown(async function(target: HyperView, action: string) {\n    // console.log(\"KEYDOWN\", target.id, action)\n    runAction(target, action)\n  })\n\n  listenKeyup(async function(target: HyperView, action: string) {\n    // console.log(\"KEYUP\", target.id, action)\n    runAction(target, action)\n  })\n\n  listenFormSubmit(async function(target: HyperView, action: string, form: FormData) {\n    // console.log(\"FORM\", target.id, action, form)\n    runAction(target, action, form)\n  })\n\n  listenChange(async function(target: HyperView, action: string) {\n    // console.log(\"CHANGE\", target.id, action)\n    runAction(target, action)\n  })\n\n  listenInput(async function(target: HyperView, action: string) {\n    runAction(target, action)\n  })\n}\n\n\n\nfunction enrichHyperViews(node: HTMLElement): void {\n  // enrich all the hyperviews\n  node.querySelectorAll(\"[id]\").forEach((element: HyperView) => {\n    element.runAction = function(action: string) {\n      runAction(this, action)\n    }.bind(element)\n\n    dispatchContent(node)\n  })\n}\n\nfunction dispatchContent(node: HTMLElement): void {\n  let event = new Event(\"hyp-content\", { bubbles: true })\n  node.dispatchEvent(event)\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", init)\n\n\n\n\n// Should we connect to the socket or not?\nconst sock = new SocketConnection()\nsock.connect()\n\n\n\n\n\n\ntype VNode = {\n  // One of three value types are used:\n  // - The tag name of the element\n  // - \"text\" if text node\n  // - \"comment\" if comment node\n  type: string\n\n  // An object whose key/value pairs are the attribute\n  // name and value, respectively\n  attributes: [string: string]\n\n  // Is set to `true` if a node is an `svg`, which tells\n  // Omdomdom to treat it, and its children, as such\n  isSVGContext: Boolean\n\n  // The content of a \"text\" or \"comment\" node\n  content: string\n\n  // An array of virtual node children\n  children: Array<VNode>\n\n  // The real DOM node\n  node: Node\n}\n\n\n\n\n\ndeclare global {\n  interface Window {\n    Hyperbole?: HyperboleAPI;\n  }\n}\n\nexport interface HyperboleAPI {\n  runAction(target: HTMLElement, action: string, form?: FormData): Promise<void>\n  action(con: string, ...params: any[]): string\n  hyperView(viewId: ViewId): HyperView | undefined\n  parseMetadata(input: string): Metadata\n  socket: SocketConnection\n}\n\n\n\n\nexport interface HyperView extends HTMLElement {\n  runAction(target: HTMLElement, action: string, form?: FormData): Promise<void>\n}\n\n\n\nwindow.Hyperbole =\n{\n  runAction: runAction,\n  parseMetadata: parseMetadata,\n  action: function(con, ...params: any[]) {\n    let ps = params.reduce((str, param) => str + \" \" + JSON.stringify(param), \"\")\n    return con + ps\n  },\n  hyperView: function(viewId) {\n    let element = document.getElementById(viewId) as any\n    if (!element?.runAction) {\n      console.error(\"Element id=\" + viewId + \" was not a HyperView\")\n      return undefined\n    }\n    return element\n  },\n  socket: sock\n}\n","\nexport function setQuery(query: string) {\n  if (query != currentQuery()) {\n    if (query != \"\") query = \"?\" + query\n    let url = location.pathname + query\n    // console.log(\"history.replaceState(\", url, \")\")\n    window.history.replaceState({}, \"\", url)\n  }\n}\n\nfunction currentQuery(): string {\n  const query = window.location.search;\n  return query.startsWith('?') ? query.substring(1) : query;\n}\n"],"names":["debounce","function_","wait","options","TypeError","RangeError","immediate","storedContext","storedArguments","timeoutId","timestamp","result","run","callContext","callArguments","undefined","apply","later","last","Date","now","setTimeout","debounced","arguments_","this","Object","getPrototypeOf","Error","callNow","defineProperty","get","clear","clearTimeout","flush","trigger","module","exports","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","hasProperty","obj","prop","prototype","hasOwnProperty","call","forEach","items","fn","length","idx","insertBefore","parent","child","refNode","node","_slicedToArray","arr","i","Array","isArray","_arrayWithHoles","_i","Symbol","iterator","_s","_e","_x","_r","_arr","_n","_d","next","done","push","value","err","return","_iterableToArrayLimit","o","minLen","_arrayLikeToArray","n","toString","slice","constructor","name","from","test","_unsupportedIterableToArray","_nonIterableRest","len","arr2","Types","DomProperties","createRecord","attrName","propName","type","_ref","_ref2","attr","property","_ref3","_ref4","Namespace","setProperty","element","style","toLowerCase","removeAttribute","parsed","parseInt","isNaN","indexOf","patch","template","vNode","rootNode","parentNode","contentChanged","content","replaceChild","assignVNode","removedAttributes","changedAttributes","attributes","oldValue","nextValue","_attrName","_oldValue","_nextValue","propertyRecord","removeAttributes","startsWith","setAttributeNS","setAttribute","setAttributes","updateAttributes","templateChildrenLength","children","vNodeChildrenLength","vNodeKeyMap","map","_","key","console","warn","keyIsValid","createKeyMap","nextChildren","templateChild","childNodes","keyedChild","vNodeChild","appendChild","childNodesLength","delta","removeChild","patchChildren","create","processedDOMString","isSVGContext","arguments","trim","replace","DOMParser","parseFromString","body","isRoot","tagName","numChildNodes","nodeType","isSVG","reduce","getBaseAttributes","attrValue","getAttribute","getPropertyValues","getAttributes","textContent","toSearch","form","params","URLSearchParams","append","parseMetadata","input","splitMetadata","split","metadata","lines","meta","requestId","metas","pred","output","a","takeWhileMap","parseMeta","rest","find","m","cookies","filter","redirect","error","query","events","breakNextSegment","data","detail","JSON","parse","parseRemoteEvent","actions","parseAction","pageTitle","ix","message","line","match","viewId","msg","protocol","window","location","defaultAddress","host","pathname","reconnectDelay","connect","addr","sock","WebSocket","onConnectError","ev","log","socket","addEventListener","_event","hasEverConnected","document","dispatchEvent","Event","isConnected","removeEventListener","sendAction","action","join","renderActionMessage","fetch","reqId","id","sendMessage","waitMessage","send","Promise","resolve","reject","onMessage","event","cookie","FetchError","disconnect","close","listenKeyEvent","cb","e","source","target","datasetKey","dataset","preventDefault","nearestTarget","listenBubblingEvent","closest","listenLoad","querySelectorAll","load","delay","onLoad","onload","CustomEvent","bubbles","listenMouseEnter","onMouseEnter","onmouseenter","listenMouseLeave","onMouseLeave","onmouseleave","targetId","targetData","nearestTargetId","getElementById","sendActionHttp","url","href","method","headers","res","text","inp","parseMetadataHttp","ok","rootStyles","PACKAGE","version","addedRulesIndex","Set","runAction","timeout","classList","add","Math","random","substring","decodeURI","search","actionMessage","runMetadataImmediate","update","doc","css","querySelector","parseResponse","src","sheet","cssRules","rule","has","cssText","insertRule","addCSS","old","dispatchContent","newTarget","runMetadataDOM","focused","focus","val","checkbox","checked","fixInputs","enrichHyperViews","innerHTML","remove","currentQuery","history","replaceState","setQuery","title","remoteEvent","view","Hyperbole","hyperView","bind","innerText","onsubmit","formData","FormData","encodedJSONInput","onchange","oninput","debouncedCallback","encodedTextInput","SocketConnection","con","str","param","stringify"],"sourceRoot":""}